<script lang="ts" context="module">
	import { gsapCreator, type CssValue, type GsapOptions } from '$lib';
	import type { Snippet } from 'svelte';
	import type { HTMLButtonAttributes } from 'svelte/elements';
	import { gsap } from 'gsap';

	export type Props = {
		size?: CssValue;
		fill: string;
		svgGsaps?: GsapOptions;
		children: Snippet;
	} & HTMLButtonAttributes;
</script>

<script lang="ts">
	const {
		size,
		class: className,
		fill = 'white',
		svgGsaps,
		children,
		...restParams
	}: Props = $props();
	const morphs = [
		'M34.9,-57.2C44.7,-48,51.7,-37.4,59.3,-25.7C66.9,-13.9,75.1,-1,74.3,11.3C73.5,23.6,63.8,35.2,54.3,48.3C44.9,61.3,35.7,75.9,23.6,78.7C11.5,81.4,-3.6,72.5,-16.6,64.9C-29.7,57.3,-40.7,51,-49,42.1C-57.3,33.1,-63,21.5,-60.2,11.3C-57.5,1.2,-46.4,-7.5,-42.7,-21.1C-38.9,-34.7,-42.5,-53.2,-36.6,-64.2C-30.7,-75.2,-15.4,-78.7,-1.4,-76.6C12.6,-74.4,25.1,-66.5,34.9,-57.2Z',
		'M42.7,-66.5C55.2,-58.3,65.3,-46.4,72.3,-32.6C79.3,-18.8,83.2,-3.1,76.7,7.8C70.2,18.8,53.2,25.1,41.9,34.1C30.6,43.1,25.1,54.8,17.2,55.8C9.4,56.8,-0.8,47,-13.9,44.5C-27,41.9,-43.1,46.6,-48.8,41.5C-54.6,36.3,-50,21.4,-49.6,8.6C-49.2,-4.3,-53,-15.1,-50.3,-23.8C-47.6,-32.5,-38.4,-39,-29,-48.6C-19.5,-58.2,-9.8,-70.8,2.6,-74.9C15,-79,30.1,-74.6,42.7,-66.5Z',
		'M30.1,-38.7C43.4,-38.4,61.6,-37.4,73.4,-28.5C85.1,-19.7,90.6,-2.9,88.1,12.5C85.7,27.9,75.3,42.1,62.1,49.4C48.9,56.8,32.9,57.3,18,62C3.1,66.7,-10.9,75.6,-19.7,71.2C-28.6,66.7,-32.4,49.1,-41.6,36.9C-50.8,24.8,-65.3,18.1,-71.5,7.3C-77.7,-3.5,-75.6,-18.5,-65.9,-26C-56.1,-33.6,-38.9,-33.6,-26.7,-34.4C-14.4,-35.2,-7.2,-36.8,0.6,-37.7C8.4,-38.7,16.9,-39,30.1,-38.7Z',
		'M34.3,-50.8C47.4,-45.1,62.8,-40.4,72.2,-30C81.6,-19.6,85,-3.4,81.6,10.9C78.3,25.2,68.1,37.8,55.4,42.5C42.7,47.2,27.4,44,14.5,46.6C1.6,49.1,-8.8,57.3,-23.4,61.4C-38,65.5,-56.8,65.5,-68.2,56.7C-79.7,47.9,-83.9,30.3,-86.4,12.5C-88.9,-5.3,-89.7,-23.3,-81.3,-35.2C-72.9,-47.1,-55.4,-53,-40.3,-57.7C-25.2,-62.5,-12.6,-66.2,-1,-64.6C10.7,-63.1,21.3,-56.4,34.3,-50.8Z',
		'M29.5,-46.7C40.5,-38.9,53.2,-34.5,55.5,-26.3C57.8,-18.1,49.7,-6,46,5.3C42.3,16.6,42.9,27.2,40.1,40.2C37.3,53.3,31.1,68.9,21.3,71.2C11.5,73.6,-1.9,62.7,-16.3,57.6C-30.8,52.5,-46.4,53.1,-52.2,45.6C-58,38.2,-54,22.7,-53.9,9.1C-53.9,-4.6,-57.7,-16.3,-54.6,-25.6C-51.4,-34.9,-41.3,-41.7,-31,-49.8C-20.8,-57.9,-10.4,-67.3,-0.6,-66.5C9.3,-65.6,18.6,-54.5,29.5,-46.7Z',
		'M29.9,-39.5C44.1,-37.3,64.7,-38.1,76.8,-29.8C88.9,-21.4,92.5,-3.8,84.9,8.5C77.3,20.7,58.5,27.6,46.5,39C34.6,50.4,29.4,66.4,18.5,75.1C7.7,83.8,-8.9,85.2,-22.2,79.5C-35.5,73.8,-45.6,61,-48.1,47.5C-50.7,34.1,-45.9,20,-51.1,5.3C-56.4,-9.4,-71.8,-24.6,-72.5,-37.3C-73.2,-49.9,-59.1,-60,-44.6,-62C-30,-64,-15,-57.9,-3.6,-52.3C7.8,-46.7,15.6,-41.6,29.9,-39.5Z',
		'M43.9,-63C55.7,-60.8,63.3,-46.6,65,-32.7C66.7,-18.8,62.5,-5.2,61.5,9.6C60.5,24.3,62.7,40.2,56.8,52.2C51,64.2,37.3,72.2,22.1,77.8C6.9,83.4,-9.7,86.6,-20.8,79.4C-31.8,72.2,-37.1,54.5,-44.2,41.2C-51.2,27.8,-59.9,18.9,-59,9.9C-58,1,-47.4,-7.9,-43.1,-20.7C-38.8,-33.5,-40.9,-50.2,-34.8,-54.9C-28.6,-59.7,-14.3,-52.6,0.9,-53.9C16.1,-55.3,32.1,-65.1,43.9,-63Z',
		'M41.8,-72.3C48.2,-60.9,43.4,-39.2,42.5,-24.3C41.5,-9.5,44.5,-1.3,45.5,8C46.4,17.3,45.2,27.7,40.4,37C35.5,46.3,26.9,54.4,15.9,60.7C4.8,67,-8.7,71.4,-19.3,67.5C-29.9,63.6,-37.4,51.3,-46.8,40.5C-56.1,29.8,-67.2,20.5,-66.8,10.7C-66.5,1,-54.7,-9.3,-50,-24.2C-45.4,-39.1,-47.8,-58.7,-40.7,-69.8C-33.5,-80.8,-16.8,-83.4,0.5,-84.2C17.7,-84.9,35.4,-83.7,41.8,-72.3Z',
		'M43.1,-71.8C53.4,-60.4,57.7,-44.4,63.5,-29.6C69.3,-14.8,76.7,-1.4,79,14.3C81.2,29.9,78.4,47.7,66.6,53.1C54.7,58.5,33.9,51.6,17.6,53.3C1.4,55,-10.4,65.3,-18.7,63.1C-27,60.9,-31.7,46.3,-36.3,34.9C-40.9,23.5,-45.4,15.3,-45.8,7.1C-46.3,-1.2,-42.7,-9.5,-38.9,-17.8C-35.1,-26,-31.1,-34.1,-24.6,-47.2C-18.1,-60.4,-9,-78.5,3.7,-84.2C16.4,-89.9,32.8,-83.2,43.1,-71.8Z',
		'M43.1,-71.8C53.4,-60.4,57.7,-44.4,63.5,-29.6C69.3,-14.8,76.7,-1.4,79,14.3C81.2,29.9,78.4,47.7,66.6,53.1C54.7,58.5,33.9,51.6,17.6,53.3C1.4,55,-10.4,65.3,-18.7,63.1C-27,60.9,-31.7,46.3,-36.3,34.9C-40.9,23.5,-45.4,15.3,-45.8,7.1C-46.3,-1.2,-42.7,-9.5,-38.9,-17.8C-35.1,-26,-31.1,-34.1,-24.6,-47.2C-18.1,-60.4,-9,-78.5,3.7,-84.2C16.4,-89.9,32.8,-83.2,43.1,-71.8Z',
		'M32.1,-56.3C39.7,-45,42.7,-32.9,52.6,-21.1C62.5,-9.3,79.3,2.2,81.6,14.3C83.9,26.4,71.8,39.1,58.7,46.5C45.5,53.9,31.3,56.1,19.1,55.2C6.9,54.2,-3.3,50.1,-14,47.2C-24.8,44.4,-36,42.7,-41.7,36.1C-47.3,29.6,-47.4,18.2,-52,5.6C-56.7,-6.9,-66,-20.6,-64.5,-31.8C-63,-42.9,-50.8,-51.5,-38.3,-60.6C-25.7,-69.6,-12.9,-79.2,-0.3,-78.7C12.2,-78.2,24.4,-67.6,32.1,-56.3Z'
	];
</script>

<div class="relative">
	<button class={className} style="width: {size}; height: {size}" {...restParams}>
		{@render children()}
		<svg
			class="absolute left-1/2 top-1/2 -z-10 -translate-x-1/2 -translate-y-1/2"
			viewBox="0 0 200 200"
			xmlns="http://www.w3.org/2000/svg"
			width={size}
			height={size}
			use:gsapCreator={svgGsaps ?? []}
		>
			<path
				transform="translate(100 100)"
				{fill}
				d="M45.8,-72C58.6,-63.1,67.7,-49.1,73.8,-34.2C79.9,-19.2,83,-3.4,80.4,11.3C77.9,26,69.6,39.6,59.5,52.1C49.5,64.6,37.6,76.1,23.8,79.4C10,82.6,-5.7,77.7,-21.1,72.7C-36.5,67.7,-51.6,62.8,-60.8,52.5C-70,42.2,-73.2,26.6,-76.8,10.3C-80.3,-6.1,-84.2,-23.2,-79.6,-37.6C-74.9,-52,-61.8,-63.9,-47.1,-71.9C-32.4,-79.8,-16.2,-84,0.2,-84.3C16.5,-84.5,33.1,-80.8,45.8,-72Z"
				use:gsapCreator={[
					({ target, getTimeline }) => {
						const timeLine = getTimeline({ repeat: -1, yoyo: true, delay: 0, ease: 'linear' });
						for (const morph of morphs) {
							timeLine.to(target, {
								attr: { d: morph },
								duration: 1
							});
						}
					}
				]}
			/>
		</svg>
	</button>
</div>
